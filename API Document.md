# API Document

这是中国海洋大学 2021 年软件工程综合实践课夕夕项目的接口文档。

## 总体

以下为对所有接口的总体概述

> 剩下的内容后端写

## 接口

### 上传图片

**接口功能**

> 上传图片

**URL**

> /api/upload

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> MultiForm

**请求字段**

> | 参数  | 必选 | 类型   | 说明                                 |
> | :---- | :--- | :----- | ------------------------------------ |
> | img   | true | file   | 图片文件（jpg、png）                 |
> | usage | true | string | 用途（”p“: 上传图片、"a": 上传头像） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 注册

**接口功能**

> 用户注册

**URL**

> /api/account/register

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数     | 必选 | 类型   | 说明                                         |
> | :------- | :--- | :----- | -------------------------------------------- |
> | username | true | string | 用户名（长度 4～30，仅含字母、数字、下划线） |
> | password | true | string | 密码（长度6～20，要求含有数字和字母）        |
> | email    | true | string | 邮箱                                         |
> | role    | true | int | 用户身份（0为买家，1为卖家）                                        |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 登录

**接口功能**

> 用户登录

**URL**

> /api/account/login

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数     | 必选 | 类型   | 说明         |
> | :------- | :--- | :----- | ------------ |
> | username | true | string | 用户名或邮箱 |
> | password | true | string | 密码         |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 注销

**接口功能**

> 用户注销

**URL**

> /api/account/logout

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> 无格式

**请求字段**

> 无参数

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 获取当前登录状态

**接口功能**

> 获取当前登录状态

**URL**

> /api/account/status

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> 无格式

**请求字段**

> 无参数

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 修改昵称

**接口功能**

> 修改昵称（要求登录）

**URL**

> /api/account/change_nickname

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数     | 必选 | 类型   | 说明              |
> | :------- | :--- | :----- | ----------------- |
> | nickname | true | string | 新昵称（50字以内） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 修改头像

**接口功能**

> 修改头像（要求登录）

**URL**

> /api/account/change_avatar

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | avatar | true | string | 图片文件在服务器的路径（上传图片时获取的） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 修改密码

**接口功能**

> 修改密码（要求登录）

**URL**

> /api/account/change_password

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | password | true | string | 密码（长度6～20，要求含有数字和字母） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 发布课程

**接口功能**

> 发布课程或将课程保存到草稿箱（要求卖家登录）

**URL**

> /api/course/add_course

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | title | true | string | 课程标题 |
> | category | true | string | 课程分类 |
> | cover | true | string | 封面图文件在服务器的路径（先上传封面图后立刻获取） |
> | price | true | int | 价格（以分为单位） |
> | content | true | string | 课程简介（富文本） |
> | publish | true | string | 是否发布课程（true发布，false保存到草稿箱） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 修改课程

**接口功能**

> 修改课程商品或保存草稿箱（要求卖家登录）

**URL**

> /api/course/edit_course

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |
> | title | true | string | 课程标题 |
> | category | true | string | 课程分类 |
> | cover | true | string | 封面图文件在服务器的路径（先上传封面图后立刻获取） |
> | price | true | int | 价格（以分为单位） |
> | content | true | string | 课程简介（富文本） |
> | publish | true | string | 是否发布课程（true发布，false保存到草稿箱） |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---
### 删除课程

**接口功能**

> 删除课程（要求卖家登录）

**URL**

> /api/course/delete_course

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

>

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 查看课程详情

**接口功能**

> 查看课程详情

**URL**

> /api/course/get_course_detail

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

> JSON

**响应字段**

> | 返回字段   | 字段类型   | 说明                                       |
> | :----- | :----- | ------------------------------------------ |
> | code | int    | 状态码 |
> | msg | string | 状态信息 |
> | author | string | 作者昵称 |
> | title | string | 课程标题 |
> | category | string | 课程分类 |
> | cover | string | 封面图文件在服务器的路径 |
> | price | int | 价格（以分为单位） |
> | content | string | 课程简介（富文本） |

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 查看课程快照

**接口功能**

> 查看课程快照详情

**URL**

> /api/course/get_course_snapshot

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | snapshot_id | true | int | 快照id |

**响应格式**

> JSON

**响应字段**

> | 返回字段   | 字段类型   | 说明                                       |
> | :----- | :----- | ------------------------------------------ |
> | code | int    | 状态码 |
> | msg | string | 状态信息 |
> | course_id | int | 对应课程id |
> | author | string | 作者昵称 |
> | title | string | 课程标题 |
> | category | string | 课程分类 |
> | cover | string | 封面图文件在服务器的路径 |
> | price | int | 价格（以分为单位） |
> | content | string | 课程简介（富文本） |

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 获取最新课程

**接口功能**

> 获取最新课程（时间降序，返回部分最新课程）

**URL**

> /api/course/get_courses_list_by_time

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> 无格式

**请求字段**

> 无格式

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 获取热门课程

**接口功能**

> 获取热门课程（销量降序，返回部分热门课程）

**URL**

> /api/course/get_courses_list_by_sales

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> 无格式

**请求字段**

> 无格式

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 获取精品课程

**接口功能**

> 获取热门课程（看后台标签，返回部分精品课程）

**URL**

> /api/course/get_courses_list_by_quality

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> 无格式

**请求字段**

> 无格式

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 搜索课程

**接口功能**

> 通过关键词和分类筛选搜索课程（分页）

**URL**

> /api/course/search

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | keyword | false | string | 搜索关键词（不填默认为空） |
> | category | false | string | 分类筛选（不填默认为空） |
> | page | false | int | 页码（不填默认为1） |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 加入购物车

**接口功能**

> 将商品加入购物车（需要买家登录）

**URL**

> /api/course/add_to_cart

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 从购物车删除

**接口功能**

> 将商品从购物车删除（需要买家登录）

**URL**

> /api/course/delete_from_cart

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 下单

**接口功能**

> 下单商品（需要买家登录）

**URL**

> /api/order/place_order

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 下单付款

**接口功能**

> 模拟付款过程（需要买家登录）

**URL**

> /api/order/payment

**访问频率限制**

>

**请求方式**

> POST

**请求格式**

> JSON

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | username | true | string | 用户名 |
> | order_id_list | true | array | 订单id数组 |
> | total_price | true | int | 总价格（分为单位） |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 查看订单详情

**接口功能**

> 查看订单详情

**URL**

> /api/order/get_order_detail

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | order_id | true | int | 订单id |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---


### 查看已购买订单（需要买家登录）

**接口功能**

> 查看已购买订单（需要买家登录）

**URL**

> /api/order/get_my_purchase

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | page | false | int | 页码（不填默认为1） |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 查看已卖出订单（需要卖家登录）

**接口功能**

> 查看已卖出订单（需要卖家登录）

**URL**

> /api/order/get_my_sale_order

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | page | false | int | 页码（不填默认为1） |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---


### 查看卖家统计（需要卖家登录）

**接口功能**

> 查看卖家统计（需要卖家登录）

**URL**

> /api/order/get_my_sale_stats

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> 无参数

**请求字段**

> 无参数

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---

### 查看我的课程商品（需要卖家登录）

**接口功能**

> 查看我的课程商品（需要卖家登录）

**URL**

> /api/course/get_my_courses

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | is_published | true | int | 是否已发布（true为已发布商品） |
> | page | false | int | 页码（不填默认为1） |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---


### 查看课程修改历史

**接口功能**

> 查看课程修改历史（需要卖家登录）

**URL**

> /api/course/get_course_history

**访问频率限制**

>

**请求方式**

> GET

**请求格式**

> Query

**请求字段**

> | 参数   | 必选 | 类型   | 说明                                       |
> | :----- | :--- | :----- | ------------------------------------------ |
> | course_id | true | int | 课程id |

**响应格式**

> JSON

**响应字段**

>

**响应状态码与状态信息**

>

**示例**

```json

```

---
